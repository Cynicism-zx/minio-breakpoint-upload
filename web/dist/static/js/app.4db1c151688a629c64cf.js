webpackJsonp([1],{0:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("QHRJ"),r=n("pSFy"),o=n.n(r),s=n("Xxa5"),i=n.n(s),u=n("exGp"),c=n.n(u),l=n("//Fk"),p=n.n(l),d=n("IaEC"),f=n.n(d),m=n("JK/3"),h=n.n(m),g=n("mw3O"),k=n.n(g),x=1048576,w=1048576,b={data:function(){return{options:{target:"",chunkSize:1048576,fileParameterName:"upfile",maxChunkRetries:3,testChunks:!0,checkChunkUploadedByResponse:function(e,t){var n=JSON.parse(t);return!!n.skipUpload||(n.uploadedChunks||[]).indexOf(e.offset+1)>=0}},attrs:{accept:[]},progress:0,status:"初始状态",urlPrex:"http://127.0.0.1:39988/minio",fileStatusText:{success:"上传成功",error:"上传失败",uploading:"上传中",paused:"暂停",waiting:"等待上传"}}},created:function(){},mounted:function(){var e=this;this.$nextTick(function(){window.uploader=e.$refs.uploader.uploader})},methods:{onFileAdded:function(e){console.log(e),this.computeMD5(e)},onFileSuccess:function(e,t,n,a){console.log(t),t.modelEvaluationId=this.modelData.id,t.refProjectId="123456789",this.$store.dispatch("mergeFile",t).then(function(e){415===e.data.code&&console.log("合并操作未成功，结果码："+e.data.code)}).catch(function(e){console.log("合并后捕获的未知异常："+e)})},onFileError:function(e,t,n,a){console.log("上传完成后异常信息："+n)},onFileProgress:function(e,t,n){console.log(t)},getSuccessChunks:function(e){return new p.a(function(t,n){h.a.get("http://127.0.0.1:39988/minio/get_chunks",{params:{md5:e.uniqueIdentifier}}).then(function(n){e.uploadID=n.data.uploadID,e.uuid=n.data.uuid,e.uploaded=n.data.uploaded,e.chunks=n.data.chunks,t(n)}).catch(function(e){n(e)})})},newMultiUpload:function(e){return console.log(e,"new_multipart"),new p.a(function(t,n){h.a.get("http://127.0.0.1:39988/minio/new_multipart",{params:{totalChunkCounts:e.totalChunkCounts,md5:e.uniqueIdentifier,size:e.size,fileName:e.name}}).then(function(n){e.uploadID=n.data.uploadID,e.uuid=n.data.uuid,t(n)}).catch(function(e){console.log(e),n(e)})})},multipartUpload:function(e){var t,n,a=this,r=(t=c()(i.a.mark(function e(t,n){var a,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(a=new XMLHttpRequest).open("PUT",t,!1),a.setRequestHeader("Content-Type","text/plain"),a.send(n.target.result),r=a.getResponseHeader("etag"),z[l]=r;case 6:case"end":return e.stop()}},e,this)})),function(e,n){return t.apply(this,arguments)}),o=(n=c()(i.a.mark(function t(n){var a,o;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(g()){t.next=17;break}return o=(a=l*w)+w>=e.size?e.size-a:w,t.next=5,x(l,o);case 5:if(""==j[l]){t.next=16;break}return t.next=8,r(j[l],n);case 8:if(""==z[l]){t.next=13;break}return t.next=11,b(l);case 11:t.next=14;break;case 13:return t.abrupt("return");case 14:t.next=17;break;case 16:return t.abrupt("return");case 17:case"end":return t.stop()}},t,this)})),function(e){return n.apply(this,arguments)}),s=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice,u=Math.ceil(e.size/w),l=0,d=new FileReader,f=(new Date).getTime();function m(){var t=l*w,n=t+w>=e.size?e.size:t+w;d.readAsArrayBuffer(s.call(e.file,t,n))}function g(){return-1!=v.indexOf((l+1).toString())}function x(t,n){return new p.a(function(a,r){h.a.get("http://127.0.0.1:39988/minio/get_multipart_url",{params:{uuid:e.uuid,uploadID:e.uploadID,size:n,chunkNumber:t+1}}).then(function(e){j[t]=e.data.url,a(e)}).catch(function(e){console.log(e),r(e)})})}function b(t){return new p.a(function(n,a){h.a.post("http://127.0.0.1:39988/minio/update_chunk",k.a.stringify({uuid:e.uuid,chunkNumber:t+1,etag:z[t]})).then(function(e){console.log("11111111111111111111111"),n(e)}).catch(function(e){console.log(e),a(e)})})}var v=new Array,y=new Array;y=e.chunks.split(",");for(var D=0;D<y.length;D++)v[D]=y[D].split("-")[0];var _,j=new Array,z=new Array;console.log("上传分片..."),this.status="上传中",m(),d.onload=(_=c()(i.a.mark(function t(n){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o(n);case 2:if(d.abort(),!(++l<u)){t.next=11;break}return console.log("第"+l+"个分片上传完成, 开始第"+(l+1)+"/"+u+"个分片上传"),a.progress=Math.ceil(l/u*100),t.next=9,m();case 9:t.next=16;break;case 11:return t.next=13,new p.a(function(t,n){h.a.post("http://127.0.0.1:39988/minio/complete_multipart",k.a.stringify({uuid:e.uuid,uploadID:e.uploadID,file_name:e.name,size:e.size})).then(function(e){t(e)}).catch(function(e){console.log(e),n(e)})});case 13:console.log("文件上传完成："+e.name+" \n分片："+u+" 大小:"+e.size+" 用时："+((new Date).getTime()-f)/1e3+" s"),a.progress=100,a.status="上传完成";case 16:case"end":return t.stop()}},t,a)})),function(e){return _.apply(this,arguments)})},computeMD5:function(e){var t=this,n=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice,a=Math.ceil(e.size/w),r=0,o=new f.a.ArrayBuffer,s=new FileReader,i=(new Date).getTime();function u(){var t=r*w,a=t+x>=e.size?e.size:t+x;s.readAsArrayBuffer(n.call(e.file,t,a))}console.log("计算MD5..."),this.status="计算MD5",e.totalChunkCounts=a,u(),s.onload=function(n){if(o.append(n.target.result),++r<a)console.log("第"+r+"分片解析完成, 开始第"+(r+1)+"/"+a+"分片解析"),u();else{var s=o.end();console.log("MD5计算完成："+e.name+" \nMD5："+s+" \n分片："+a+" 大小:"+e.size+" 用时："+((new Date).getTime()-i)/1e3+" s"),o.destroy(),e.uniqueIdentifier=s,e.cmd5=!1,t.computeMD5Success(e)}},s.onerror=function(){console.warn("oops, something went wrong."),e.cancel()}},computeMD5Success:function(e){var t=this;return c()(i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return function(e){return new p.a(function(t,n){h.a.post("http://127.0.0.1:39988/minio/add",k.a.stringify({uuid:e.uuid,file_name:e.name,size:e.size})).then(function(e){t(e)}).catch(function(e){console.log(e),n(e)})})},n.next=3,t.getSuccessChunks(e);case 3:if(""!=e.uploadID&&""!=e.uuid){n.next=14;break}return n.next=6,t.newMultiUpload(e);case 6:if(""==e.uploadID||""==e.uuid){n.next=11;break}e.chunks="",t.multipartUpload(e),n.next=12;break;case 11:return n.abrupt("return");case 12:n.next=15;break;case 14:"1"==e.uploaded?(console.log("文件已上传完成"),t.progress=100,t.status="上传完成"):t.multipartUpload(e);case 15:case"end":return n.stop()}},n,t)}))()}}},v={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("uploader",{ref:"uploader",staticClass:"uploader-example",attrs:{options:e.options,autoStart:!0,"file-status-text":e.fileStatusText},on:{"file-added":e.onFileAdded,"file-success":e.onFileSuccess,"file-progress":e.onFileProgress,"file-error":e.onFileError}},[n("uploader-unsupport"),e._v(" "),n("uploader-drop",[n("div",[n("p",[e._v("将文件拖放到此处以上传或")]),e._v(" "),n("uploader-btn",{ref:"uploadBtn",attrs:{id:"global-uploader-btn",attrs:e.attrs}},[e._v("选择文件"),n("i",{staticClass:"el-icon-upload el-icon--right"})])],1)]),e._v(" "),n("uploader-list"),e._v(" "),n("p",[e._v("文件处理状态："+e._s(e.status))]),e._v(" "),n("p",[e._v("文件上传进度："+e._s(e.progress)+"%")])],1)},staticRenderFns:[]};var y=n("5a/D")(b,v,!1,function(e){n("jiyz")},null,null).exports;a.a.use(o.a),new a.a({render:function(e){return e(y)}}).$mount("#uploader")},gm86:function(e,t){e.exports={name:"axios",version:"0.21.4",description:"Promise based HTTP client for the browser and node.js",main:"index.js",scripts:{test:"grunt test",start:"node ./sandbox/server.js",build:"NODE_ENV=production grunt build",preversion:"npm test",version:"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json",postversion:"git push && git push --tags",examples:"node ./examples/server.js",coveralls:"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js",fix:"eslint --fix lib/**/*.js"},repository:{type:"git",url:"https://github.com/axios/axios.git"},keywords:["xhr","http","ajax","promise","node"],author:"Matt Zabriskie",license:"MIT",bugs:{url:"https://github.com/axios/axios/issues"},homepage:"https://axios-http.com",devDependencies:{coveralls:"^3.0.0","es6-promise":"^4.2.4",grunt:"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1",karma:"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2",minimist:"^1.2.0",mocha:"^8.2.1",sinon:"^4.5.0","terser-webpack-plugin":"^4.2.3",typescript:"^4.0.5","url-search-params":"^0.10.0",webpack:"^4.44.2","webpack-dev-server":"^3.11.0"},browser:{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},jsdelivr:"dist/axios.min.js",unpkg:"dist/axios.min.js",typings:"./index.d.ts",dependencies:{"follow-redirects":"^1.14.0"},bundlesize:[{path:"./dist/axios.min.js",threshold:"5kB"}]}},jiyz:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.4db1c151688a629c64cf.js.map
